%include pages/header_template

    <script>

        $(document).ready(function () {

            var tablesList = {{!tables}};
            for (var i = 0; i < tablesList.length; i++) {
                $('#tables').append('<option value="' + tablesList[i] + '">' + tablesList[i] + '</option>')
            }

            var alertError = {{!alerterror}};
            var alertSuccess = {{!alertsuccess}};

            if (alertError.length > 0) {
                errors = removeDuplicates(alertError);
                for (var err in errors) {
                    //noinspection JSUnfilteredForInLoop
                    $('#form').before('<div class="alert alert-error">' +
                            '<button class="close" data-dismiss="alert">×</button>' +
                            alertError[err] + '</div>');
                }
            }

            if (alertSuccess.length > 0) {
                results = removeDuplicates(alertSuccess);
                for (var success in results) {
                    //noinspection JSUnfilteredForInLoop
                    $('#form').before('<div class="alert alert-success">' +
                            '<button class="close" data-dismiss="alert">×</button>' +
                            alertSuccess[success] + '</div>');
                }
                $('#methods').before('<div class="span4" id="result">' +
                        '<div class="span3"><h4>Result</h4></div>' +
                        '   <div class="span3 well">' +
                        '       <form action="/download/{{file}}">' +
                        '           <button class="btn {{btn}}">Download</button> {{file}}' +
                        '       </form>' +
                        '   </div>' +
                        '</div>');
            }
        })

    </script>
%include pages/analytics
</head>

<body>

<div class="container">
    <div class="span8">
        <h2>Welcome to <img src="static/img/favicon.ico" alt="PaR-PaR favicon"/>PaR-PaR!</h2>
        <p>A new simple way to make your experiments faster.<br/>Write your code in the window below, add a table file and click 'Prepare robot file'.<br/>The resulting file will be available for you to download on the right.</p>
		<p><a href="/copyright">Copyright</a>&nbsp;&nbsp;::&nbsp;&nbsp;<a href="/disclaimer">Disclaimer</a>&nbsp;&nbsp;::&nbsp;&nbsp;<a href="http://pubs.acs.org/doi/abs/10.1021/sb300075t">Paper</a>&nbsp;&nbsp;::&nbsp;&nbsp;<a href="https://github.com/JBEI/parpar">Get code</a></p>
        <p><a href="static/pdf/PaR-PaR-v0.31-howto.pdf">PaR-PaR Howto guide (PDF)</a>&nbsp;&nbsp;::&nbsp;&nbsp;<a href="#" id="sampleScript" onclick="LoadSampleScript()">Load sample script</a></p>
    </div>
    <div class="span1 inline pull-right"><a href="mailto:nstawski@lbl.gov?subject=PaR-PaR%20v.{{version}}%20feedback" class="label label-info">Version {{version}}</a></div>
    <div class="span12">
        <div class="row" id="script">
            <span class="pull-right"><a href="#" id="methodsToggle" onclick="$('#methods').removeClass('hidden');">Setup custom methods</a></span>
            <div class="span8">
                <h4>Script</h4>
                <div id="myModal" class="modal hide fade in parpar-modal">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h3 id="platename">Plate file name</h3>
                    </div>
                    <div class="modal-body">
                        <div id="tablerow">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a href="#" class="btn" data-dismiss="modal">Close</a>
                    </div>
                </div>

                <form action="/getconfig" method="post" enctype="multipart/form-data" id="form">

                <div class="controls" id="table">
                    <select id="tables" class="span3" name="tableselect" onchange = "clicked();">
                        <option value="select">Select table file</option>
                    </select>
                    <input type="file" name="data" id="data" class="span3" onchange="AppendUploadButton()"/>
                </div>
                <textarea class="input-xlarge span8" id="textarea" rows="30" name="text">{{text}}</textarea>
                <button class="btn pull-right" type="submit" name="upload" >&nbsp;Prepare robot file&nbsp;</button>
                <textarea class="hidden" id="methodsList" name="methods"></textarea>
                </form>
            </div>
            <div id="methods" class="span4 hidden">
                <div class="span3">
                    <h5>Custom methods</h5>
                    <div class="input-append" id="newMethod">
                        <input class="span3" id="userMethod" size="16" type="text"><button class="btn" type="button" onclick="customizeMethods();">Add new</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
	<div class="span12"><footer>
	        <p>If you have questions or comments, email <a href="mailto:nstawski@lbl.gov?subject=PaR-PaR%20v.{{version}}%20feedback">Nina Stawski</a>.</p>
	</footer></div>
</div>

%include pages/footer_template